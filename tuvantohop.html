<!DOCTYPE html>
<html lang="vi" dir="ltr">
<head>
    <meta charset="utf-8">
    <title>T∆∞ v·∫•n ch·ªçn t·ªï h·ª£p theo nƒÉng l·ª±c h·ªçc t·∫≠p</title>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
            position: relative;
            padding-bottom: 60px;
        }
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 800px;
        }
        .DiemTHCS, .DiemTHCS2 {
            padding: 15px;
            border-radius: 8px;
            background-color: #ffffff;
            color: #333;
            box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
        }
        .DiemTHCS table, .DiemTHCS2 table {
            width: 100%;
            border-collapse: collapse;
        }
        .DiemTHCS th, .DiemTHCS td {
            padding: 8px 5px;
            border: 1px solid #ddd;
            text-align: center;
        }
        .display-box {
            font-family: 'Orbitron', sans-serif;
            background-color: #e9ecef;
            border: 1px solid #ced4da;
            color: #495057;
            border-radius: 4px;
            width: 100%;
            height: 35px;
            text-align: center;
            box-sizing: border-box;
            padding: 0 5px;
        }
        .display-title {
            font-family: 'Orbitron', sans-serif;
            background-color: #87CEFA;
            border: 1px solid #ced4da;
            color: #333;
            border-radius: 4px;
            width: 100%;
            height: 35px;
            text-align: left;
            padding-left: 5px;
            box-sizing: border-box;
            font-weight: bold;
        }
        .display-title2 {
            font-family: 'Orbitron', sans-serif;
            background-color: #87CEFA;
            border: 1px solid #ced4da;
            color: #333;
            border-radius: 4px;
            width: 100%;
            height: 35px;
            text-align: center;
            box-sizing: border-box;
            font-weight: bold;
        }
        .button {
            font-family: sans-serif;
            background-color: #007bff;
            color: white;
            border: none;
            width: 100%;
            border-radius: 4px;
            height: 40px;
            outline: none;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s ease;
        }
        .button:hover {
            background-color: #0056b3;
        }
        .button:active {
            background: #004085;
            box-shadow: inset 0px 0px 5px rgba(0, 0, 0, 0.2);
        }
        #excelFile {
            display: none;
        }
        label[for="excelFile"] {
            display: inline-block;
            background-color: #6c757d;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            font-size: 14px;
            transition: background-color 0.2s ease;
        }
        label[for="excelFile"]:hover {
            background-color: #5a6268;
        }
        #fileName {
            font-style: italic;
            color: #666;
            margin-left: 5px;
        }
        .button-download {
            background-color: #28a745;
        }
        .button-download:hover {
            background-color: #218838;
        }
        .button-clear {
            background-color: #dc3545;
        }
        .button-clear:hover {
            background-color: #c82333;
        }
        .result-container {
            width: 100%;
            height: 150px;
            overflow-y: auto;
            border: 1px solid #dae0e5;
            border-radius: 4px;
            background-color: #e2e6ea;
            padding: 10px;
            box-sizing: border-box;
        }
        .result-box {
            width: 100%;
            text-align: center;
            color: #1a1a1a;
            font-size: 16px;
            font-weight: bold;
            white-space: pre-line;
            word-wrap: break-word;
        }
        .result-container::-webkit-scrollbar {
            width: 8px;
        }
        .result-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        .result-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        .result-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #f8f9fa;
            text-align: center;
            padding: 10px 0;
            font-size: 14px;
            color: #6c757d;
            border-top: 1px solid #dee2e6;
            z-index: 100;
        }
        .chart-container {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: #ffffff;
            box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
        }
        .two-columns {
            display: flex;
            gap: 20px;
        }
        .two-columns > div {
            flex: 1;
        }
        @media (max-width: 768px) {
            .two-columns {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="DiemTHCS">
            <table>
                <tr>
                    <td><input class="display-title" type="text" value="" disabled /></td>
                    <td><input class="display-title2" type="text" value="L·ªõp 6" disabled /></td>
                    <td><input class="display-title2" type="text" value="L·ªõp 7" disabled /></td>
                    <td><input class="display-title2" type="text" value="L·ªõp 8" disabled /></td>
                    <td><input class="display-title2" type="text" value="L·ªõp 9" disabled /></td>
                </tr>
                <tr>
                    <td><input class="display-title" type="text" value="Ng·ªØ vƒÉn" disabled /></td>
                    <td><input class="display-box" type="text" id="van6" value="" /></td>
                    <td><input class="display-box" type="text" id="van7" value="" /></td>
                    <td><input class="display-box" type="text" id="van8" value="" /></td>
                    <td><input class="display-box" type="text" id="van9" value="" /></td>
                </tr>
                <tr>
                    <td><input class="display-title" type="text" value="To√°n" disabled /></td>
                    <td><input class="display-box" type="text" id="toan6" value="" /></td>
                    <td><input class="display-box" type="text" id="toan7" value="" /></td>
                    <td><input class="display-box" type="text" id="toan8" value="" /></td>
                    <td><input class="display-box" type="text" id="toan9" value="" /></td>
                </tr>
                <tr>
                    <td><input class="display-title" type="text" value="Ngo·∫°i ng·ªØ 1" disabled /></td>
                    <td><input class="display-box" type="text" id="anh6" value="" /></td>
                    <td><input class="display-box" type="text" id="anh7" value="" /></td>
                    <td><input class="display-box" type="text" id="anh8" value="" /></td>
                    <td><input class="display-box" type="text" id="anh9" value="" /></td>
                </tr>
                <tr>
                    <td><input class="display-title" type="text" value="Gi√°o d·ª•c c√¥ng d√¢n" disabled /></td>
                    <td><input class="display-box" type="text" id="gdcd6" value="" /></td>
                    <td><input class="display-box" type="text" id="gdcd7" value="" /></td>
                    <td><input class="display-box" type="text" id="gdcd8" value="" /></td>
                    <td><input class="display-box" type="text" id="gdcd9" value="" /></td>
                </tr>
                <tr>
                    <td><input class="display-title" type="text" value="L·ªãch s·ª≠ - ƒê·ªãa l√Ω" disabled /></td>
                    <td><input class="display-box" type="text" id="lsdl6" value="" /></td>
                    <td><input class="display-box" type="text" id="lsdl7" value="" /></td>
                    <td><input class="display-box" type="text" id="lsdl8" value="" /></td>
                    <td><input class="display-box" type="text" id="lsdl9" value="" /></td>
                </tr>
                <tr>
                    <td><input class="display-title" type="text" value="Khoa h·ªçc t·ª± nhi√™n" disabled /></td>
                    <td><input class="display-box" type="text" id="khtn6" value="" /></td>
                    <td><input class="display-box" type="text" id="khtn7" value="" /></td>
                    <td><input class="display-box" type="text" id="khtn8" value="" /></td>
                    <td><input class="display-box" type="text" id="khtn9" value="" /></td>
                </tr>
                <tr>
                    <td><input class="display-title" type="text" value="C√¥ng ngh·ªá" disabled /></td>
                    <td><input class="display-box" type="text" id="cn6" value="" /></td>
                    <td><input class="display-box" type="text" id="cn7" value="" /></td>
                    <td><input class="display-box" type="text" id="cn8" value="" /></td>
                    <td><input class="display-box" type="text" id="cn9" value="" /></td>
                </tr>
                <tr>
                    <td><input class="display-title" type="text" value="Tin h·ªçc" disabled /></td>
                    <td><input class="display-box" type="text" id="th6" value="" /></td>
                    <td><input class="display-box" type="text" id="th7" value="" /></td>
                    <td><input class="display-box" type="text" id="th8" value="" /></td>
                    <td><input class="display-box" type="text" id="th9" value="" /></td>
                </tr>
                <tr>
                    <td><input class="display-title" type="text" value="Ngh·ªá thu·∫≠t" disabled /></td>
                    <td><input class="display-box" type="text" id="nghethuat6" value="" /></td>
                    <td><input class="display-box" type="text" id="nghethuat7" value="" /></td>
                    <td><input class="display-box" type="text" id="nghethuat8" value="" /></td>
                    <td><input class="display-box" type="text" id="nghethuat9" value="" /></td>
                </tr>
                <tr>
                    <td><input class="display-title" type="text" value="Ho·∫°t ƒë·ªông tr·∫£i nghi·ªám" disabled /></td>
                    <td><input class="display-box" type="text" id="hoatdong6" value="" /></td>
                    <td><input class="display-box" type="text" id="hoatdong7" value="" /></td>
                    <td><input class="display-box" type="text" id="hoatdong8" value="" /></td>
                    <td><input class="display-box" type="text" id="hoatdong9" value="" /></td>
                </tr>
            </table>
        </div>
        <div class="DiemTHCS2">
            <table>
                <tr>
                    <td colspan="2">
                        <label for="excelFile">üìÅ File ƒëi·ªÉm</label>
                        <span id="fileName">Ch∆∞a ch·ªçn file n√†o</span>
                    </td>
                    <td><input class="button" type="button" id="mau2" value="ƒê·ªçc d·ªØ li·ªáu t·ª´ file"/></td>
                </tr>
                <tr>
                    <td><input class="button" type="button" id="tuvan" value="T∆∞ v·∫•n ch·ªçn t·ªï h·ª£p"/></td>
                    <td><input class="button button-clear" type="button" id="xoa" value="X√≥a"/></td>
                    <td>
                        <a href="https://docs.google.com/spreadsheets/d/12LE1T-fZDEmBTrQCzmQNjRHgfTy9X5Cy/edit?usp=sharing&ouid=113662691499014817150&rtpof=true&sd=true" download>
                            <input class="button button-download" type="button" value="Download file m·∫´u"/>
                        </a>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <div class="result-container">
                            <div class="result-box" id="kqtuvan"></div>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        
        <div class="chart-container">
            <h3>Bi·ªÉu ƒë·ªì nƒÉng l·ª±c h·ªçc t·∫≠p</h3>
            <div class="two-columns">
                <div>
                    <canvas id="barChart"></canvas>
                </div>
                <div>
                    <canvas id="radarChart"></canvas>
                </div>
            </div>
        </div>
    </div>
    <footer>
        Cu·ªôc thi khoa h·ªçc kƒ© thu·∫≠t c·∫•p tr∆∞·ªùng
    </footer>
    <input type="file" id="excelFile" accept=".xls,.xlsx"/>
    <script>
        // Bi·∫øn to√†n c·ª•c ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu bi·ªÉu ƒë·ªì
        let barChart = null;
        let radarChart = null;
        let selectedFile;
        
        // S·ª≠a l·ªói ƒë·ªçc file Excel
        document.getElementById('excelFile').addEventListener('change', function (e) {
            selectedFile = e.target.files[0];
            document.getElementById('fileName').textContent = selectedFile ? selectedFile.name : "Ch∆∞a ch·ªçn file n√†o";
        });
        
        document.getElementById('mau2').addEventListener('click', function () {
            if (!selectedFile) {
                alert("Vui l√≤ng ch·ªçn m·ªôt file Excel tr∆∞·ªõc.");
                return;
            }
            const reader = new FileReader();
            reader.onload = function (e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(sheet);
                    
                    if (jsonData.length === 0) {
                        alert("File Excel kh√¥ng c√≥ d·ªØ li·ªáu ho·∫∑c kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng.");
                        return;
                    }
                    
                    // L·∫•y d√≤ng ƒë·∫ßu ti√™n
                    const row = jsonData[0];
                    
                    // ƒê·ªçc d·ªØ li·ªáu v·ªõi nhi·ªÅu t√™n c·ªôt c√≥ th·ªÉ c√≥
                    document.getElementById("van6").value = row["Van6"] || row["Ng·ªØ vƒÉn 6"] || "";
                    document.getElementById("van7").value = row["Van7"] || row["Ng·ªØ vƒÉn 7"] || "";
                    document.getElementById("van8").value = row["Van8"] || row["Ng·ªØ vƒÉn 8"] || "";
                    document.getElementById("van9").value = row["Van9"] || row["Ng·ªØ vƒÉn 9"] || "";
                    
                    document.getElementById("toan6").value = row["Toan6"] || row["To√°n 6"] || "";
                    document.getElementById("toan7").value = row["Toan7"] || row["To√°n 7"] || "";
                    document.getElementById("toan8").value = row["Toan8"] || row["To√°n 8"] || "";
                    document.getElementById("toan9").value = row["Toan9"] || row["To√°n 9"] || "";
                    
                    document.getElementById("anh6").value = row["Anh6"] || row["Anh vƒÉn 6"] || row["Ngo·∫°i ng·ªØ 6"] || "";
                    document.getElementById("anh7").value = row["Anh7"] || row["Anh vƒÉn 7"] || row["Ngo·∫°i ng·ªØ 7"] || "";
                    document.getElementById("anh8").value = row["Anh8"] || row["Anh vƒÉn 8"] || row["Ngo·∫°i ng·ªØ 8"] || "";
                    document.getElementById("anh9").value = row["Anh9"] || row["Anh vƒÉn 9"] || row["Ngo·∫°i ng·ªØ 9"] || "";
                    
                    document.getElementById("gdcd6").value = row["GDCD6"] || row["GDCD 6"] || row["Gi√°o d·ª•c c√¥ng d√¢n 6"] || "";
                    document.getElementById("gdcd7").value = row["GDCD7"] || row["GDCD 7"] || row["Gi√°o d·ª•c c√¥ng d√¢n 7"] || "";
                    document.getElementById("gdcd8").value = row["GDCD8"] || row["GDCD 8"] || row["Gi√°o d·ª•c c√¥ng d√¢n 8"] || "";
                    document.getElementById("gdcd9").value = row["GDCD9"] || row["GDCD 9"] || row["Gi√°o d·ª•c c√¥ng d√¢n 9"] || "";
                    
                    document.getElementById("lsdl6").value = row["LSDL6"] || row["LSƒêL6"] || row["L·ªãch s·ª≠ - ƒê·ªãa l√Ω 6"] || "";
                    document.getElementById("lsdl7").value = row["LSDL7"] || row["LSƒêL7"] || row["L·ªãch s·ª≠ - ƒê·ªãa l√Ω 7"] || "";
                    document.getElementById("lsdl8").value = row["LSDL8"] || row["LSƒêL8"] || row["L·ªãch s·ª≠ - ƒê·ªãa l√Ω 8"] || "";
                    document.getElementById("lsdl9").value = row["LSDL9"] || row["LSƒêL9"] || row["L·ªãch s·ª≠ - ƒê·ªãa l√Ω 9"] || "";
                    
                    document.getElementById("khtn6").value = row["KHTN6"] || row["KHTN 6"] || row["Khoa h·ªçc t·ª± nhi√™n 6"] || "";
                    document.getElementById("khtn7").value = row["KHTN7"] || row["KHTN 7"] || row["Khoa h·ªçc t·ª± nhi√™n 7"] || "";
                    document.getElementById("khtn8").value = row["KHTN8"] || row["KHTN 8"] || row["Khoa h·ªçc t·ª± nhi√™n 8"] || "";
                    document.getElementById("khtn9").value = row["KHTN9"] || row["KHTN 9"] || row["Khoa h·ªçc t·ª± nhi√™n 9"] || "";
                    
                    document.getElementById("cn6").value = row["CongNghe6"] || row["C√¥ng ngh·ªá 6"] || "";
                    document.getElementById("cn7").value = row["CongNghe7"] || row["C√¥ng ngh·ªá 7"] || "";
                    document.getElementById("cn8").value = row["CongNghe8"] || row["C√¥ng ngh·ªá 8"] || "";
                    document.getElementById("cn9").value = row["CongNghe9"] || row["C√¥ng ngh·ªá 9"] || "";
                    
                    document.getElementById("th6").value = row["Tin6"] || row["Tin h·ªçc 6"] || "";
                    document.getElementById("th7").value = row["Tin7"] || row["Tin h·ªçc 7"] || "";
                    document.getElementById("th8").value = row["Tin8"] || row["Tin h·ªçc 8"] || "";
                    document.getElementById("th9").value = row["Tin9"] || row["Tin h·ªçc 9"] || "";
                    
                    document.getElementById("nghethuat6").value = row["NgheThuat6"] || row["Ngh·ªá thu·∫≠t 6"] || "";
                    document.getElementById("nghethuat7").value = row["NgheThuat7"] || row["Ngh·ªá thu·∫≠t 7"] || "";
                    document.getElementById("nghethuat8").value = row["NgheThuat8"] || row["Ngh·ªá thu·∫≠t 8"] || "";
                    document.getElementById("nghethuat9").value = row["NgheThuat9"] || row["Ngh·ªá thu·∫≠t 9"] || "";
                    
                    document.getElementById("hoatdong6").value = row["HoatDong6"] || row["Ho·∫°t ƒë·ªông tr·∫£i nghi·ªám 6"] || "";
                    document.getElementById("hoatdong7").value = row["HoatDong7"] || row["Ho·∫°t ƒë·ªông tr·∫£i nghi·ªám 7"] || "";
                    document.getElementById("hoatdong8").value = row["HoatDong8"] || row["Ho·∫°t ƒë·ªông tr·∫£i nghi·ªám 8"] || "";
                    document.getElementById("hoatdong9").value = row["HoatDong9"] || row["Ho·∫°t ƒë·ªông tr·∫£i nghi·ªám 9"] || "";
                    
                    alert("D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c ƒë·ªçc th√†nh c√¥ng!");
                } catch (error) {
                    console.error("L·ªói khi ƒë·ªçc file Excel:", error);
                    alert("ƒê√£ x·∫£y ra l·ªói khi ƒë·ªçc file Excel. Vui l√≤ng ki·ªÉm tra ƒë·ªãnh d·∫°ng file.");
                }
            };
            reader.readAsArrayBuffer(selectedFile);
        });
        
        // S·ª≠a l·ªói t∆∞ v·∫•n t·ªï h·ª£p
        document.getElementById("tuvan").onclick = function() {
            // L·∫•y d·ªØ li·ªáu ƒëi·ªÉm t·ª´ c√°c √¥ input
            let van6 = parseFloat(document.getElementById('van6').value) || 0;
            let van7 = parseFloat(document.getElementById('van7').value) || 0;
            let van8 = parseFloat(document.getElementById('van8').value) || 0;
            let van9 = parseFloat(document.getElementById('van9').value) || 0;
            
            let toan6 = parseFloat(document.getElementById('toan6').value) || 0;
            let toan7 = parseFloat(document.getElementById('toan7').value) || 0;
            let toan8 = parseFloat(document.getElementById('toan8').value) || 0;
            let toan9 = parseFloat(document.getElementById('toan9').value) || 0;
            
            let anh6 = parseFloat(document.getElementById('anh6').value) || 0;
            let anh7 = parseFloat(document.getElementById('anh7').value) || 0;
            let anh8 = parseFloat(document.getElementById('anh8').value) || 0;
            let anh9 = parseFloat(document.getElementById('anh9').value) || 0;
            
            let gdcd6 = parseFloat(document.getElementById('gdcd6').value) || 0;
            let gdcd7 = parseFloat(document.getElementById('gdcd7').value) || 0;
            let gdcd8 = parseFloat(document.getElementById('gdcd8').value) || 0;
            let gdcd9 = parseFloat(document.getElementById('gdcd9').value) || 0;
            
            let lsdl6 = parseFloat(document.getElementById('lsdl6').value) || 0;
            let lsdl7 = parseFloat(document.getElementById('lsdl7').value) || 0;
            let lsdl8 = parseFloat(document.getElementById('lsdl8').value) || 0;
            let lsdl9 = parseFloat(document.getElementById('lsdl9').value) || 0;
            
            let khtn6 = parseFloat(document.getElementById('khtn6').value) || 0;
            let khtn7 = parseFloat(document.getElementById('khtn7').value) || 0;
            let khtn8 = parseFloat(document.getElementById('khtn8').value) || 0;
            let khtn9 = parseFloat(document.getElementById('khtn9').value) || 0;
            
            let cn6 = parseFloat(document.getElementById('cn6').value) || 0;
            let cn7 = parseFloat(document.getElementById('cn7').value) || 0;
            let cn8 = parseFloat(document.getElementById('cn8').value) || 0;
            let cn9 = parseFloat(document.getElementById('cn9').value) || 0;
            
            let th6 = parseFloat(document.getElementById('th6').value) || 0;
            let th7 = parseFloat(document.getElementById('th7').value) || 0;
            let th8 = parseFloat(document.getElementById('th8').value) || 0;
            let th9 = parseFloat(document.getElementById('th9').value) || 0;
            
            // H√†m t√≠nh ƒëi·ªÉm trung b√¨nh
            const calculateAverage = (scores) => {
                const validScores = scores.filter(s => s > 0);
                return validScores.length > 0 ? 
                    (validScores.reduce((sum, s) => sum + s, 0) / validScores.length).toFixed(2) : 0;
            };
            
            // T√≠nh ƒëi·ªÉm trung b√¨nh c√°c m√¥n
            let tbVan = parseFloat(calculateAverage([van6, van7, van8, van9]));
            let tbToan = parseFloat(calculateAverage([toan6, toan7, toan8, toan9]));
            let tbAnh = parseFloat(calculateAverage([anh6, anh7, anh8, anh9]));
            let tbGDCD = parseFloat(calculateAverage([gdcd6, gdcd7, gdcd8, gdcd9]));
            let tbLSDL = parseFloat(calculateAverage([lsdl6, lsdl7, lsdl8, lsdl9]));
            let tbKHTN = parseFloat(calculateAverage([khtn6, khtn7, khtn8, khtn9]));
            let tbCN = parseFloat(calculateAverage([cn6, cn7, cn8, cn9]));
            let tbTH = parseFloat(calculateAverage([th6, th7, th8, th9]));
            
            // T·∫°o bi·ªÉu ƒë·ªì
            createCharts(tbVan, tbToan, tbAnh, tbGDCD, tbLSDL, tbKHTN, tbCN, tbTH);
            
            // ƒê√°nh gi√° nƒÉng l·ª±c
            let allSubjects = [
                van6, van7, van8, van9,
                toan6, toan7, toan8, toan9,
                anh6, anh7, anh8, anh9,
                gdcd6, gdcd7, gdcd8, gdcd9,
                lsdl6, lsdl7, lsdl8, lsdl9,
                khtn6, khtn7, khtn8, khtn9,
                cn6, cn7, cn8, cn9,
                th6, th7, th8, th9
            ];
            
            let tbAll = calculateAverage(allSubjects);
            
            let subjectsScores = [
                { name: "Ng·ªØ vƒÉn", score: tbVan },
                { name: "To√°n", score: tbToan },
                { name: "Ngo·∫°i ng·ªØ", score: tbAnh },
                { name: "Gi√°o d·ª•c c√¥ng d√¢n", score: tbGDCD },
                { name: "L·ªãch s·ª≠ - ƒê·ªãa l√Ω", score: tbLSDL },
                { name: "Khoa h·ªçc t·ª± nhi√™n", score: tbKHTN },
                { name: "C√¥ng ngh·ªá", score: tbCN },
                { name: "Tin h·ªçc", score: tbTH }
            ];
            
            let highScoringSubjects = subjectsScores.filter(subject => subject.score >= 6.5);
            
            if (highScoringSubjects.length < 2) {
                subjectsScores.sort((a, b) => b.score - a.score);
                let topSubject = subjectsScores[0];
                let secondSubject = subjectsScores[1];
                let recommendedVocations = [];
                
                if (topSubject.score < 5.0) {
                    recommendedVocations.push("Hi·ªán t·∫°i ƒëi·ªÉm s·ªë c√°c m√¥n ƒë·ªÅu th·∫•p, b·∫°n n√™n t·∫≠p trung c·∫£i thi·ªán h·ªçc l·ª±c tr∆∞·ªõc khi ch·ªçn ngh·ªÅ.");
                } else {
                    switch(topSubject.name) {
                        case "To√°n":
                        case "Khoa h·ªçc t·ª± nhi√™n":
                            recommendedVocations.push("S·ª≠a ch·ªØa ƒëi·ªán", "C∆° kh√≠ l·∫Øp r√°p", "Ch·∫ø bi·∫øn th·ª±c ph·∫©m");
                            if (secondSubject.name === "C√¥ng ngh·ªá" && secondSubject.score >= 6.0) {
                                recommendedVocations.push("May c√¥ng nghi·ªáp");
                            }
                            break;
                        case "C√¥ng ngh·ªá":
                            recommendedVocations.push("May c√¥ng nghi·ªáp", "C∆° kh√≠ l·∫Øp r√°p", "H√†n c∆° kh√≠");
                            break;
                        case "Tin h·ªçc":
                            recommendedVocations.push("S·ª≠a ch·ªØa thi·∫øt b·ªã ƒëi·ªán t·ª≠", "L·∫Øp r√°p m√°y t√≠nh", "C√†i ƒë·∫∑t ph·∫ßn m·ªÅm c∆° b·∫£n");
                            break;
                        case "Ng·ªØ vƒÉn":
                        case "Gi√°o d·ª•c c√¥ng d√¢n":
                            recommendedVocations.push("Nh√¢n vi√™n d·ªãch v·ª• kh√°ch h√†ng", "Th∆∞ k√Ω vƒÉn ph√≤ng", "H·ªó tr·ª£ h√†nh ch√≠nh");
                            break;
                        case "Ngo·∫°i ng·ªØ":
                            recommendedVocations.push("Nh√¢n vi√™n l·ªÖ t√¢n", "H·ªó tr·ª£ du l·ªãch c∆° b·∫£n", "Nh√¢n vi√™n b√°n h√†ng");
                            break;
                        case "L·ªãch s·ª≠ - ƒê·ªãa l√Ω":
                            recommendedVocations.push("H·ªó tr·ª£ du l·ªãch ƒë·ªãa ph∆∞∆°ng", "Nh√¢n vi√™n b·∫£o v·ªá m√¥i tr∆∞·ªùng", "C√¥ng nh√¢n n√¥ng nghi·ªáp");
                            break;
                    }
                }
                
                let resultText = "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê T∆Ø V·∫§N H∆Ø·ªöNG NGHI·ªÜP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";
                resultText += `üìâ ƒêi·ªÉm trung b√¨nh t·∫•t c·∫£ c√°c m√¥n: ${tbAll}\n\n`;
                resultText += "üè≠ G·ª¢I √ù H·ªåC NGH·ªÄ:\n";
                resultText += `D·ª±a tr√™n nƒÉng l·ª±c c·ªßa b·∫°n, b·∫°n n√™n c√¢n nh·∫Øc h·ªçc c√°c ngh·ªÅ sau:\n`;
                recommendedVocations.forEach(vocation => {
                    resultText += `üîπ ${vocation}\n`;
                });
                resultText += "\nüìä ƒêI·ªÇM TRUNG B√åNH C√ÅC M√îN:\n";
                resultText += `- Ng·ªØ vƒÉn: ${tbVan}\n`;
                resultText += `- To√°n: ${tbToan}\n`;
                resultText += `- Ngo·∫°i ng·ªØ: ${tbAnh}\n`;
                resultText += `- Khoa h·ªçc t·ª± nhi√™n: ${tbKHTN}\n`;
                resultText += `- L·ªãch s·ª≠ - ƒê·ªãa l√Ω: ${tbLSDL}\n`;
                resultText += `- C√¥ng ngh·ªá: ${tbCN}\n`;
                resultText += `- Tin h·ªçc: ${tbTH}\n\n`;
                resultText += "üí° L·ªúI KHUY√äN: ƒêi·ªÉm s·ªë hi·ªán t·∫°i cho th·∫•y b·∫°n ph√π h·ª£p v·ªõi c√°c ch∆∞∆°ng tr√¨nh ƒë√†o t·∫°o ngh·ªÅ c∆° b·∫£n. H√£y ch·ªçn ngh·ªÅ ph√π h·ª£p v·ªõi s·ªü th√≠ch v√† nƒÉng l·ª±c, ƒë·ªìng th·ªùi ti·∫øp t·ª•c c·∫£i thi·ªán c√°c m√¥n h·ªçc ƒë·ªÉ c√≥ th√™m c∆° h·ªôi. Li√™n h·ªá v·ªõi trung t√¢m h∆∞·ªõng nghi·ªáp ƒë·ªÉ bi·∫øt th√™m chi ti·∫øt.";
                
                document.getElementById("kqtuvan").textContent = resultText;
                return;
            }
            
            // T√≠nh ƒëi·ªÉm c√°c t·ªï h·ª£p
            const toHop = [
                {
                    name: "A00 (To√°n, V·∫≠t l√Ω, H√≥a h·ªçc)",
                    subjects: ["To√°n", "KHTN"],
                    weights: [0.6, 0.4],
                    check: () => tbToan >= 6.5 && tbKHTN >= 6.5
                },
                {
                    name: "B00 (To√°n, H√≥a h·ªçc, Sinh h·ªçc)",
                    subjects: ["To√°n", "KHTN"],
                    weights: [0.5, 0.5],
                    check: () => tbToan >= 6.5 && tbKHTN >= 6.5
                },
                {
                    name: "A01 (To√°n, V·∫≠t l√Ω, Ti·∫øng Anh)",
                    subjects: ["To√°n", "KHTN", "Anh"],
                    weights: [0.4, 0.3, 0.3],
                    check: () => tbToan >= 6.5 && tbKHTN >= 6.5 && tbAnh >= 6.5
                },
                {
                    name: "D01 (To√°n, Ng·ªØ vƒÉn, Ti·∫øng Anh)",
                    subjects: ["To√°n", "VƒÉn", "Anh"],
                    weights: [0.4, 0.3, 0.3],
                    check: () => tbToan >= 6.5 && tbVan >= 6.5 && tbAnh >= 6.5
                },
                {
                    name: "C00 (Ng·ªØ vƒÉn, L·ªãch s·ª≠, ƒê·ªãa l√Ω)",
                    subjects: ["VƒÉn", "LSDL"],
                    weights: [0.5, 0.5],
                    check: () => tbVan >= 6.5 && tbLSDL >= 6.5
                }
            ];
            
            let diemToHop = toHop
                .filter(comb => comb.check())
                .map(comb => {
                    let diem = 0;
                    comb.subjects.forEach((subject, index) => {
                        switch(subject) {
                            case "VƒÉn": diem += tbVan * comb.weights[index]; break;
                            case "To√°n": diem += tbToan * comb.weights[index]; break;
                            case "Anh": diem += tbAnh * comb.weights[index]; break;
                            case "GDCD": diem += tbGDCD * comb.weights[index]; break;
                            case "LSDL": diem += tbLSDL * comb.weights[index]; break;
                            case "KHTN": diem += tbKHTN * comb.weights[index]; break;
                            case "CN": diem += tbCN * comb.
